function ValidateClient(a){this.config={};this.$fb=a;this.maxnumerrors=-1}ValidateClient.prototype.clone=function(c){if(c==null||typeof(c)!="object"){return c}var a={};for(var b in c){a[b]=this.clone(c[b])}return a};ValidateClient.prototype.init_editor=function(){this.$fb("#fb-submit-button").click(function(){return false})};ValidateClient.prototype.init_client=function(a){var b=this;this.$fb("#docContainer input:submit, #docContainer button:submit").click(function(c){b.$fb("#docContainer .placeholder").val("");if(b.$fb("#docContainer").attr("data-form")=="automated"||b.$fb("#docContainer").attr("data-form")=="publish"){if(!b.$fb("#docContainer").valid()){var d=b.$fb("#docContainer").attr("action");var e=b.$fb("#docContainer").validate().numberOfInvalids();d=d.replace(/(?:\.php)|\/$/i,"/fbapp/api/formchangestats.php?error="+e);b.$fb.get(d)}}if(b.$fb("#docContainer").attr("data-form")!="preview"){if(b.$fb(this).attr("data-disabled")){c.preventDefault();c.stopPropagation();return false}if(b.$fb("#docContainer").valid()){b.$fb(this).attr("data-disabled","disabled");if(window.parent&&window.parent.document&&window.parent.document.getElementById("fb_iframe")&&b.$fb("#docContainer").attr("data-form")=="manual_iframe"){b.$fb("body",window.parent.document).scrollTop(b.$fb("iframe",window.parent.document).position().top)}}}b.$fb.fb_resize();return true});if(a){this.$fb.validator.setDefaults({submitHandler:function(c){if(b.$fb(c).valid()){alert("Submitted!")}}})}this.$fb("#docContainer").validate({errorPlacement:function(d,e){if(b.maxnumerrors!=-1){var c=0;b.$fb.each(b.$fb("#docContainer label.error"),function(g,f){if(b.$fb(f).css("display")!="none"){c++}});if(c>=b.maxnumerrors){return}}offset=e.offset();if(b.$fb(e).attr("type")=="checkbox"||b.$fb(e).attr("type")=="radio"){b.$fb(d).css("width","100%");b.$fb(e).parent().parent().append(b.$fb(d))}else{if(b.$fb(e).attr("id")=="recaptcha_response_field"){b.$fb("#fb-captcha_control").append(b.$fb(d))}else{b.$fb(d).insertAfter(b.$fb(e))}}d.addClass("message")}});this.set_config(JSON.parse(data_validation));this.add_rules()};ValidateClient.prototype.set_config=function(a){this.config=this.clone(a)};ValidateClient.prototype.set_config_json=function(a){if(typeof a=="undefined"||a===null||typeof a!="string"){return false}this.config=JSON.parse(a);return true};ValidateClient.prototype.add_rule_type=function(d,k){if(arguments.length!=2){return false}if(typeof this.config[d]=="undefined"||this.config[d]===null){return false}if(typeof this.config[d][k]=="undefined"||this.config[d][k]===null||this.config[d][k]==""){return false}if(d!="sigpad"&&d!="reCaptcha"&&d!="_special"&&!this.$fb("#"+d).length){return false}var n=this;if(k=="date_config"){this.$fb("#"+d).attr("id","").removeClass("hasDatepicker").removeData("datepicker").unbind().attr("id",d).datepicker({onClose:function(){n.$fb("#docContainer").validate().element(this)},showAnim:""});for(var c in this.config[d][k]){if(this.config[d][k].hasOwnProperty(c)){var g={};if(c=="minDate"||c=="maxDate"){if(this.config[d][k][c]!=""){g[c]=new Date(this.config[d][k][c])}}else{g[c]=this.config[d][k][c]}this.$fb("#"+d).datepicker("option",c,g[c])}}}else{if(k=="hover"){var f=document.getElementById("form_init_script").getAttribute("data-name");for(var l in this.config[d][k]){var m=this.$fb("#"+d).css(l);var i=n.config[d][k][l];if((this.$fb("#docContainer").attr("data-form")=="automated"&&this.$fb("#docContainer").attr("action")!="./")||(this.$fb("#docContainer").attr("data-form")=="manual_iframe"&&this.$fb("#docContainer").attr("action")!="../"+f+".php")){i=i!=""?i.substr(0,4)+f+i.substr(4,i.length):i}if(i!="none"&&i!=""){var e=i.substr(i.indexOf("(")+1,i.indexOf(")")-i.indexOf("(")-1);var j=m.substr(m.indexOf("(")+1,m.indexOf(")")-m.indexOf("(")-1);this.$fb("<img/>").attr("src",e);this.$fb("<img/>").attr("src",j.replace(/['"]/g,""))}var n=this;this.$fb("#"+d).hover(function(){if(i!="none"&&i!=""){n.$fb(this).css("background-image",i)}else{if(i=="none"){n.$fb(this).css("background-image",m)}else{n.$fb(this).css("background-image","")}}},function(){n.$fb(this).css("background-image",m)})}}else{if(k=="maxnumerrors"){if(this.config[d][k]!=undefined&&this.config[d][k]!=""){this.maxnumerrors=this.config[d][k]}}else{if(k=="captcha"){if(this.config[d][k]&&this.$fb("#recaptcha_response_field").length){var a={};a.required=true;if(typeof(this.config[d].messages)=="string"){var b={};b.required=this.config[d].messages;a.messages=b}this.$fb("#recaptcha_response_field").rules("add",a)}}else{if(k=="sigpad"){this.$fb("#fb-sigpad_control canvas").attr("width",parseInt(this.$fb("#fb-sigpad_control canvas").css("width")));this.$fb("#fb-sigpad_control .sigpad-width").val(parseInt(this.$fb("#fb-sigpad_control canvas").css("width")));this.$fb("#fb-sigpad_control .sigpad-height").val(parseInt(this.$fb("#fb-sigpad_control canvas").css("height")));this.$fb("#fb-sigpad_control .sigpad-prefix").val(this.config[d]["prefix"]||"sigpad");this.$fb("#docContainer").signaturePad({drawOnly:true,output:".sigpad-output",clear:".sigPad_clear",errorClass:"sigpad-error",lineTop:parseInt(this.$fb("#fb-sigpad_control .sigWrapper").css("height"))-20,errorMessageDraw:this.config[d]["messages"],bgColour:this.config[d]["sigpad_canvas_color"]||"#ffffff",penColour:this.config[d]["sigpad_pen_color"]||"#145394",lineColour:this.config[d]["sigpad_line_color"]||"#cccccc",onFormError:function(q,o,p){if(q.drawInvalid){if(n.$fb(".sigpad-error").length===0){n.$fb(".sigWrapper").append('<label class="sigpad-error error"/>')}n.$fb(".sigpad-error").text(p.errorMessageDraw)}if(n.$fb("#fb-submit-button").attr("data-disabled")==="disabled"){n.$fb("#fb-submit-button").removeAttr("data-disabled")}}})}else{if(this.$fb("#"+d).length>0&&k.indexOf("sigpad_")===-1){var a={};a[k]=this.config[d][k];if(typeof(this.config[d].messages)=="string"){var b={};b[k]=this.config[d].messages;if(k=="range"){b.max=this.config[d].messages;b.min=this.config[d].messages}a.messages=b}if(k=="equalTo"){var h=this.config[d].equalTo.substring(1,this.config[d].equalTo.length);if(typeof(this.config[h].messages)=="string"){var b={};b[k]=this.config[h].messages;a.messages=b}}this.$fb("#"+d).rules("add",a)}}}}}}return true};ValidateClient.prototype.add_rule_id=function(b){if(arguments.length!=1){return false}if(typeof this.config[b]=="undefined"||this.config[b]===null){return false}for(var a in this.config[b]){if(this.config[b].hasOwnProperty(a)){this.add_rule_type(b,a)}}return true};ValidateClient.prototype.add_rules=function(){for(var a in this.config){if(this.config.hasOwnProperty(a)){this.add_rule_id(a)}}return true};